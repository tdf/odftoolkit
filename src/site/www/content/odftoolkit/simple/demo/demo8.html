<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<!--

    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE- 2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->

<link href="/odftoolkit/css/odf.css" rel="stylesheet" type="text/css">

<title></title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-28945571-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>

<body>
  <div id="banner">
   <!-- <div id="bannerleft"><a alt="Apache ODF Toolkit (incubating)" href="http://incubator.apache.org/odftoolkit/">
      <img id="logo" alt="Apache ODF Toolkit (Incubating)" src="/odftoolkit/images/ooo-logo.png"/></a></div> -->
    <div id="bannerright"><a alt="Apache Incubator" href="http://incubator.apache.org">
      <img id="asf-logo" alt="Apache Incubator" src="/odftoolkit/images/apache-incubator-logo.png"/></a></div>
   <div id="bannercenter"><br/>&nbsp;&nbsp;&nbsp;&nbsp;Apache ODF Toolkit (incubating)</div>
  </div>
  <div id="clear"></div>
  
  <div id="sidenav">
    <style type="text/css">
/* The following code is added by mdx_elementid.py
   It was originally lifted from http://subversion.apache.org/style/site.css */
/*
 * Hide class="elementid-permalink", except when an enclosing heading
 * has the :hover property.
 */
.headerlink, .elementid-permalink {
  visibility: hidden;
}
h2:hover > .headerlink, h3:hover > .headerlink, h1:hover > .headerlink, h6:hover > .headerlink, h4:hover > .headerlink, h5:hover > .headerlink, dt:hover > .elementid-permalink { visibility: visible }</style>
<h1 id="general">General<a class="headerlink" href="#general" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="/odftoolkit/index.html">About</a></li>
<li><a href="/odftoolkit/downloads.html">Downloads</a></li>
<li><a href="http://incubator.apache.org/projects/odftoolkit.html">Incubator page</a></li>
<li><a href="/odftoolkit/license.html">License</a></li>
<li><a href="/odftoolkit/privacy.html">Privacy Policy</a></li>
</ul>
<h1 id="components">Components<a class="headerlink" href="#components" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="/odftoolkit/odfdom/index.html">ODFDOM</a></li>
<li><a href="/odftoolkit/simple/index.html">Simple API</a></li>
<li><a href="/odftoolkit/conformance/ODFValidator.html">ODF Validator</a></li>
<li><a href="/odftoolkit/xsltrunner/ODFXSLTRunner.html">XSLT Runner</a></li>
</ul>
<h1 id="community">Community<a class="headerlink" href="#community" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="/odftoolkit/get-involved.html">Get Involved</a></li>
<li><a href="/odftoolkit/mailing-lists.html">Mailing Lists</a></li>
<li><a href="/odftoolkit/people.html">People</a></li>
<li><a href="/odftoolkit/community-faqs.html">Community FAQs</a></li>
</ul>
<h1 id="development">Development<a class="headerlink" href="#development" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="/odftoolkit/source.html">Source Code</a></li>
<li><a href="https://issues.apache.org/jira/browse/ODFTOOLKIT">Bug Tracker</a></li>
<li><a href="/odftoolkit/mvn-site/0.6-incubating/" target="_blank">Maven Reports</a></li>
<li><a href="/odftoolkit/website-local.html">Website</a></li>
<li><a href="/odftoolkit/developer-faqs.html">Developer FAQs</a></li>
</ul>
<h1 id="ppmc">PPMC<a class="headerlink" href="#ppmc" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="/odftoolkit/ppmc-faqs.html">PPMC FAQs</a></li>
<li><a href="/odftoolkit/odftoolkit-release-guide.html">Release Guide</a>   </li>
</ul>
<h1 id="asf">ASF<a class="headerlink" href="#asf" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="http://www.apache.org">Apache Software Foundation</a></li>
<li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
<li><a href="http://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li>
</ul>
  </div>
  <div id="contenta">
  
    
    <style type="text/css">
/* The following code is added by mdx_elementid.py
   It was originally lifted from http://subversion.apache.org/style/site.css */
/*
 * Hide class="elementid-permalink", except when an enclosing heading
 * has the :hover property.
 */
.headerlink, .elementid-permalink {
  visibility: hidden;
}
h2:hover > .headerlink, h3:hover > .headerlink, h1:hover > .headerlink, h6:hover > .headerlink, h4:hover > .headerlink, h5:hover > .headerlink, dt:hover > .elementid-permalink { visibility: visible }</style>
<p><a href="index.html"><strong>Demos</strong></a> &gt; <b>Add 2D barcode image to a slide</b>   </p>
<p><strong>Overview</strong>    </p>
<p>This demo shows the power of image and metadata support in Simple API.  </p>
<p>A 2D bar code is a special image that can be scanned by a smart phone or a dedicated scanner. It could contain a URL, a books ISBN number a vCard for a person's contact, information, etc. It makes it easy to transfer information into a smartphone from a physical object, like a printed document, or a newspaper or magazine.   </p>
<p>In this demo, the contact information of a document's author has been put in the metadata of a presentation document, with an ODF editor, such as IBM Lotus Symphony. The contact information in the metadata is extracted with the Simple ODF API, and wrapped into JSON object. Then a RESTful web service is called to generate a 2D bar code image based on this JSON object.    </p>
<p>The bar code image is then added to the first slide of this presentation using the Simple API.   </p>
<p>This picture shows how the contact information is added to the metadata of this document.    </p>
<p><img alt="image1" src="image/demo8_metadata.bmp" /></p>
<p>This picture shows the 2D bar code image added to the first slide of this presentation document.<br /><br/> 
<img alt="image2" src="image/demo8_slide.bmp" />   </p>
<p><strong>Code Introduction</strong>  </p>
<p>There code of this demo is very simple. First, we load the presentation document, and extract the metadata with Simple ODF API. Second, we invoke the web service to generate the bar code image and get the URI of this image.    </p>
<p>Finally, we get the subtitle text box in the first slide, add an image just below of this subtitle text box. Please note how FrameRectangle is used to specify the image position.    </p>
<div class="codehilite"><pre><span></span>public static void main(String[] args) {

    try {
        //load the presentation
        PresentationDocument presentation = PresentationDocument.loadDocument(&quot;Demotemplate.odp&quot;);
        //get the metadata
        Meta metaData = new Meta(presentation.getMetaDom());
        String creator = metaData.getCreator();
        String mailto = metaData.getUserDefinedDataValue(&quot;Email&quot;);
        String phoneno = metaData.getUserDefinedDataValue(&quot;Phone&quot;);

        //invoke the 2D barcode service, and get the url
        BarcodeImageGeneration demo = new BarcodeImageGeneration();
        String url = demo.invokepost(creator,mailto,phoneno);

        //Add the image to the first slide
        Slide slide = presentation.getSlideByIndex(0);
        Textbox subtitleBox = slide.getTextboxByUsage(PresentationClass.SUBTITLE).get(0);
        FrameRectangle subtitleRect = subtitleBox.getRectangle();
        Image image = Image.newImage(slide, new URI(url));
        FrameRectangle imageRect = image.getRectangle();
        imageRect.setX(subtitleRect.getX()+(subtitleRect.getWidth()-imageRect.getWidth())/2);
        imageRect.setY(subtitleRect.getY()+subtitleRect.getHeight());
        image.setRectangle(imageRect);

        presentation.save(&quot;output.odp&quot;);

    } catch (Exception e) {
        e.printStackTrace();
    }

}
</pre></div>


<p><strong>Download</strong>  </p>
<p>Powered by the Simple Java API for ODF version <a href="../downloads.html">0.5.5</a>. <br />
You can download the code of this demo from <a href="TwoDBarcodeDemo.zip">here</a>.<br />
The dependent library jslib.zip can be downloaded from <a href="http://puzzle.dl.sourceforge.net/sourceforge/xulmaker/jslib.zip">here</a>.</p>
  </div>

  <div id="footera">
    <div id="poweredby">
      <p><img src="/odftoolkit/images/feather-small.gif"/><br/>Powered by the Apache CMS.</p>
    </div>
    <div id="copyrighta">
      <p>
	Apache "ODF Toolkit" is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator.
	Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and
	decision making process	have stabilized in a manner consistent with other successful ASF projects. While incubation status is
	not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has
	yet to be fully endorsed by the ASF.</p>
      <p>
	Copyright &copy; 2011 The Apache Software Foundation Licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
	<a href="/openofficeorg/contact.html">Contact Us</a>
	<br />Apache and the Apache feather logos are trademarks of The Apache Software Foundation.
	<br />Other names appearing on the site may be trademarks of their respective owners.
      </p>
    </div>
  </div>

</body>
</html>
